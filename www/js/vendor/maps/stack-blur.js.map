{"version":3,"sources":["stack-blur.js"],"names":["stackBlurCanvasRGBA","canvas","top_x","top_y","width","height","radius","isNaN","imageData","context","getContext","getImageData","x","y","i","p","yp","yi","yw","r_sum","g_sum","b_sum","a_sum","r_out_sum","g_out_sum","b_out_sum","a_out_sum","r_in_sum","g_in_sum","b_in_sum","a_in_sum","pr","pg","pb","pa","rbs","pixels","data","div","widthMinus1","heightMinus1","radiusPlus1","sumFactor","stackStart","BlurStack","stack","next","stackEnd","stackIn","stackOut","mul_sum","mul_table","shg_sum","shg_table","r","g","b","a","putImageData","this","exports"],"mappings":"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AI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5D,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAGrDE,WACH,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC3D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAC5D,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAqPzDO,SAAQ3D,OAASD","file":"stack-blur.js","sourcesContent":["/*\n\n StackBlur - a fast almost Gaussian Blur For Canvas\n\n Version: \t0.5\n Author:\t\tMario Klingemann\n Contact: \tmario@quasimondo.com\n Website:\thttp://www.quasimondo.com/StackBlurForCanvas\n Twitter:\t@quasimondo\n\n In case you find this class useful - especially in commercial projects -\n I am not totally unhappy for a small donation to my PayPal account\n mario@quasimondo.de\n\n Or support me on flattr:\n https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\n Copyright (c) 2010 Mario Klingemann\n\n Permission is hereby granted, free of charge, to any person\n obtaining a copy of this software and associated documentation\n files (the \"Software\"), to deal in the Software without\n restriction, including without limitation the rights to use,\n copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the\n Software is furnished to do so, subject to the following\n conditions:\n\n The above copyright notice and this permission notice shall be\n included in all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n OTHER DEALINGS IN THE SOFTWARE.\n */\n\nvar mul_table = [\n\t512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,\n\t454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,\n\t482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,\n\t437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,\n\t497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,\n\t320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,\n\t446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,\n\t329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,\n\t505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,\n\t399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,\n\t324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,\n\t268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,\n\t451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,\n\t385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,\n\t332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,\n\t289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];\n\n\nvar shg_table = [\n\t9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17,\n\t17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19,\n\t19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20,\n\t20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21,\n\t21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,\n\t21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22,\n\t22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,\n\t22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23,\n\t23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n\t23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n\t23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n\t23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24 ];\n\nfunction stackBlurCanvasRGBA( canvas, top_x, top_y, width, height, radius )\n{\n\tif ( isNaN(radius) || radius < 1 ) return;\n\tradius |= 0;\n\n\tvar context = canvas.getContext(\"2d\");\n\tvar imageData;\n\n\timageData = context.getImageData( top_x, top_y, width, height );\n\n\tvar pixels = imageData.data;\n\n\tvar x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum,\n\t\tr_out_sum, g_out_sum, b_out_sum, a_out_sum,\n\t\tr_in_sum, g_in_sum, b_in_sum, a_in_sum,\n\t\tpr, pg, pb, pa, rbs;\n\n\tvar div = radius + radius + 1;\n\tvar widthMinus1  = width - 1;\n\tvar heightMinus1 = height - 1;\n\tvar radiusPlus1  = radius + 1;\n\tvar sumFactor = radiusPlus1 * ( radiusPlus1 + 1 ) / 2;\n\n\tvar stackStart = new BlurStack();\n\tvar stack = stackStart;\n\tfor ( i = 1; i < div; i++ )\n\t{\n\t\tstack = stack.next = new BlurStack();\n\t\tif ( i == radiusPlus1 ) var stackEnd = stack;\n\t}\n\tstack.next = stackStart;\n\tvar stackIn = null;\n\tvar stackOut = null;\n\n\tyw = yi = 0;\n\n\tvar mul_sum = mul_table[radius];\n\tvar shg_sum = shg_table[radius];\n\n\tfor ( y = 0; y < height; y++ )\n\t{\n\t\tr_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;\n\n\t\tr_out_sum = radiusPlus1 * ( pr = pixels[yi] );\n\t\tg_out_sum = radiusPlus1 * ( pg = pixels[yi+1] );\n\t\tb_out_sum = radiusPlus1 * ( pb = pixels[yi+2] );\n\t\ta_out_sum = radiusPlus1 * ( pa = pixels[yi+3] );\n\n\t\tr_sum += sumFactor * pr;\n\t\tg_sum += sumFactor * pg;\n\t\tb_sum += sumFactor * pb;\n\t\ta_sum += sumFactor * pa;\n\n\t\tstack = stackStart;\n\n\t\tfor( i = 0; i < radiusPlus1; i++ )\n\t\t{\n\t\t\tstack.r = pr;\n\t\t\tstack.g = pg;\n\t\t\tstack.b = pb;\n\t\t\tstack.a = pa;\n\t\t\tstack = stack.next;\n\t\t}\n\n\t\tfor( i = 1; i < radiusPlus1; i++ )\n\t\t{\n\t\t\tp = yi + (( widthMinus1 < i ? widthMinus1 : i ) << 2 );\n\t\t\tr_sum += ( stack.r = ( pr = pixels[p])) * ( rbs = radiusPlus1 - i );\n\t\t\tg_sum += ( stack.g = ( pg = pixels[p+1])) * rbs;\n\t\t\tb_sum += ( stack.b = ( pb = pixels[p+2])) * rbs;\n\t\t\ta_sum += ( stack.a = ( pa = pixels[p+3])) * rbs;\n\n\t\t\tr_in_sum += pr;\n\t\t\tg_in_sum += pg;\n\t\t\tb_in_sum += pb;\n\t\t\ta_in_sum += pa;\n\n\t\t\tstack = stack.next;\n\t\t}\n\n\n\t\tstackIn = stackStart;\n\t\tstackOut = stackEnd;\n\t\tfor ( x = 0; x < width; x++ )\n\t\t{\n\t\t\tpixels[yi+3] = pa = (a_sum * mul_sum) >> shg_sum;\n\t\t\tif ( pa != 0 )\n\t\t\t{\n\t\t\t\tpa = 255 / pa;\n\t\t\t\tpixels[yi]   = ((r_sum * mul_sum) >> shg_sum) * pa;\n\t\t\t\tpixels[yi+1] = ((g_sum * mul_sum) >> shg_sum) * pa;\n\t\t\t\tpixels[yi+2] = ((b_sum * mul_sum) >> shg_sum) * pa;\n\t\t\t} else {\n\t\t\t\tpixels[yi] = pixels[yi+1] = pixels[yi+2] = 0;\n\t\t\t}\n\n\t\t\tr_sum -= r_out_sum;\n\t\t\tg_sum -= g_out_sum;\n\t\t\tb_sum -= b_out_sum;\n\t\t\ta_sum -= a_out_sum;\n\n\t\t\tr_out_sum -= stackIn.r;\n\t\t\tg_out_sum -= stackIn.g;\n\t\t\tb_out_sum -= stackIn.b;\n\t\t\ta_out_sum -= stackIn.a;\n\n\t\t\tp =  ( yw + ( ( p = x + radius + 1 ) < widthMinus1 ? p : widthMinus1 ) ) << 2;\n\n\t\t\tr_in_sum += ( stackIn.r = pixels[p]);\n\t\t\tg_in_sum += ( stackIn.g = pixels[p+1]);\n\t\t\tb_in_sum += ( stackIn.b = pixels[p+2]);\n\t\t\ta_in_sum += ( stackIn.a = pixels[p+3]);\n\n\t\t\tr_sum += r_in_sum;\n\t\t\tg_sum += g_in_sum;\n\t\t\tb_sum += b_in_sum;\n\t\t\ta_sum += a_in_sum;\n\n\t\t\tstackIn = stackIn.next;\n\n\t\t\tr_out_sum += ( pr = stackOut.r );\n\t\t\tg_out_sum += ( pg = stackOut.g );\n\t\t\tb_out_sum += ( pb = stackOut.b );\n\t\t\ta_out_sum += ( pa = stackOut.a );\n\n\t\t\tr_in_sum -= pr;\n\t\t\tg_in_sum -= pg;\n\t\t\tb_in_sum -= pb;\n\t\t\ta_in_sum -= pa;\n\n\t\t\tstackOut = stackOut.next;\n\n\t\t\tyi += 4;\n\t\t}\n\t\tyw += width;\n\t}\n\n\n\tfor ( x = 0; x < width; x++ )\n\t{\n\t\tg_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;\n\n\t\tyi = x << 2;\n\t\tr_out_sum = radiusPlus1 * ( pr = pixels[yi]);\n\t\tg_out_sum = radiusPlus1 * ( pg = pixels[yi+1]);\n\t\tb_out_sum = radiusPlus1 * ( pb = pixels[yi+2]);\n\t\ta_out_sum = radiusPlus1 * ( pa = pixels[yi+3]);\n\n\t\tr_sum += sumFactor * pr;\n\t\tg_sum += sumFactor * pg;\n\t\tb_sum += sumFactor * pb;\n\t\ta_sum += sumFactor * pa;\n\n\t\tstack = stackStart;\n\n\t\tfor( i = 0; i < radiusPlus1; i++ )\n\t\t{\n\t\t\tstack.r = pr;\n\t\t\tstack.g = pg;\n\t\t\tstack.b = pb;\n\t\t\tstack.a = pa;\n\t\t\tstack = stack.next;\n\t\t}\n\n\t\typ = width;\n\n\t\tfor( i = 1; i <= radius; i++ )\n\t\t{\n\t\t\tyi = ( yp + x ) << 2;\n\n\t\t\tr_sum += ( stack.r = ( pr = pixels[yi])) * ( rbs = radiusPlus1 - i );\n\t\t\tg_sum += ( stack.g = ( pg = pixels[yi+1])) * rbs;\n\t\t\tb_sum += ( stack.b = ( pb = pixels[yi+2])) * rbs;\n\t\t\ta_sum += ( stack.a = ( pa = pixels[yi+3])) * rbs;\n\n\t\t\tr_in_sum += pr;\n\t\t\tg_in_sum += pg;\n\t\t\tb_in_sum += pb;\n\t\t\ta_in_sum += pa;\n\n\t\t\tstack = stack.next;\n\n\t\t\tif( i < heightMinus1 )\n\t\t\t{\n\t\t\t\typ += width;\n\t\t\t}\n\t\t}\n\n\t\tyi = x;\n\t\tstackIn = stackStart;\n\t\tstackOut = stackEnd;\n\t\tfor ( y = 0; y < height; y++ )\n\t\t{\n\t\t\tp = yi << 2;\n\t\t\tpixels[p+3] = pa = (a_sum * mul_sum) >> shg_sum;\n\t\t\tif ( pa > 0 )\n\t\t\t{\n\t\t\t\tpa = 255 / pa;\n\t\t\t\tpixels[p]   = ((r_sum * mul_sum) >> shg_sum ) * pa;\n\t\t\t\tpixels[p+1] = ((g_sum * mul_sum) >> shg_sum ) * pa;\n\t\t\t\tpixels[p+2] = ((b_sum * mul_sum) >> shg_sum ) * pa;\n\t\t\t} else {\n\t\t\t\tpixels[p] = pixels[p+1] = pixels[p+2] = 0;\n\t\t\t}\n\n\t\t\tr_sum -= r_out_sum;\n\t\t\tg_sum -= g_out_sum;\n\t\t\tb_sum -= b_out_sum;\n\t\t\ta_sum -= a_out_sum;\n\n\t\t\tr_out_sum -= stackIn.r;\n\t\t\tg_out_sum -= stackIn.g;\n\t\t\tb_out_sum -= stackIn.b;\n\t\t\ta_out_sum -= stackIn.a;\n\n\t\t\tp = ( x + (( ( p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1 ) * width )) << 2;\n\n\t\t\tr_sum += ( r_in_sum += ( stackIn.r = pixels[p]));\n\t\t\tg_sum += ( g_in_sum += ( stackIn.g = pixels[p+1]));\n\t\t\tb_sum += ( b_in_sum += ( stackIn.b = pixels[p+2]));\n\t\t\ta_sum += ( a_in_sum += ( stackIn.a = pixels[p+3]));\n\n\t\t\tstackIn = stackIn.next;\n\n\t\t\tr_out_sum += ( pr = stackOut.r );\n\t\t\tg_out_sum += ( pg = stackOut.g );\n\t\t\tb_out_sum += ( pb = stackOut.b );\n\t\t\ta_out_sum += ( pa = stackOut.a );\n\n\t\t\tr_in_sum -= pr;\n\t\t\tg_in_sum -= pg;\n\t\t\tb_in_sum -= pb;\n\t\t\ta_in_sum -= pa;\n\n\t\t\tstackOut = stackOut.next;\n\n\t\t\tyi += width;\n\t\t}\n\t}\n\n\tcontext.putImageData( imageData, top_x, top_y );\n\n}\nexports.canvas = stackBlurCanvasRGBA;\n\nfunction BlurStack()\n{\n\tthis.r = 0;\n\tthis.g = 0;\n\tthis.b = 0;\n\tthis.a = 0;\n\tthis.next = null;\n}\n"],"sourceRoot":"/source/"}