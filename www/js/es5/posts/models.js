"use strict";System.register([],function(t,e){var i,s,n,o;return{setters:[],execute:function(){i=require("../main"),s=i._,n=i.Backbone,o=i.state,exports.Post=n.Model.extend({idAttribute:"num",initialize:function(){o.posts.add(this)},dispatch:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;e>s;s++)i[s-1]=arguments[s];this.trigger.apply(this,["dispatch",t].concat(i))},remove:function(){this.stopListening().dispatch("remove"),o.posts.remove(this)},update:function(t,e,i){var n={body:this.get("body")+t};e&&s.extend(this.get("links"),e),i&&(n.dice=(this.get("dice")||[]).concat(i)),this.set(n)},setImage:function(t,e){this.set("image",t),e||this.dispatch("renderImage",t)},setSpoiler:function(t,e){var i=this.get("image");i.spoiler=t,this.dispatch("renderImage",i),this.moderationInfo(e)},removeImage:function(t){this.moderationInfo(t)||this.unset("image").dispatch("renderImage")},deletePost:function(t){this.moderationInfo(t)||this.remove()},setBan:function(t,e){t&&this.set("ban",!0).dispatch("renderBan"),this.moderationInfo(e)},addBacklink:function(t,e){var i=this.get("backlinks")||{};i[t]=e,this.set({backlinks:i}).dispatch("renderBacklinks",i)},moderationInfo:function(t){if(!t)return!1;var e=this.get("mod")||[];return e.push(t),this.set("mod",e).dispatch("renderModerationInfo",e),!0}}),exports.Thread=exports.Post.extend({defaults:{replies:[],omit:0,image_omit:0},initialize:function(){this.get("omit")&&this.getImageOmit(),o.posts.add(this)},remove:function(){this.stopListening().dispatch("remove"),o.posts.remove(this);for(var t=this.get("replies"),e=0,i=t.length;i>e;e++){var s=o.posts.get(t[e]);s&&s.remove()}},getImageOmit:function(){for(var t=this.get("imgctr")-1,e=this.get("replies"),i=0,s=e.length;s>i;i++){var n=o.posts.get(e[i]);n&&n.get("image")&&t--}this.set("image_omit",t)},toggleLocked:function(t,e){this.moderationInfo(e),this.set("locked",t).dispatch("renderLocked",t)}})}}});
//# sourceMappingURL=../maps/posts/models.js.map
