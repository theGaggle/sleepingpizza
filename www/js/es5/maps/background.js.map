{"version":3,"sources":["background.js"],"names":["System","register","_export","_context","_taggedTemplateLiteral","strings","raw","Object","freeze","defineProperties","value","_templateObject","_templateObject2","_templateObject3","main","Backbone","common","etc","oneeSama","options","stackBlur","state","BackgroundView","setters","execute","require","View","extend","tagName","colourMap","glass","normal","editing","ocean","initialize","document","head","append","this","el","body","parseDOM","render","reply","store","listenTo","change:userBG","change:illyaBGToggle","change:illyaMuteToggle","change:theme","workModeTOG","target","_this","request","reader","FileReader","readAsDataURL","files","onload","event","img","Image","canvas","createElement","width","height","getContext","drawImage","localStorage","background","toDataURL","blurred","get","src","result","innerHTML","hotConfig","renderIllya","workMode","renderBackground","bg","html","parseHTML","theme","_localStorage","renderGlass","_colourMap$theme","urlBase","config","MEDIA_URL","defer","module","exports"],"mappings":"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","file":"background.js","sourcesContent":["'use strict';System.register([],function(_export,_context){var _templateObject,_templateObject2,_templateObject3,main,Backbone,common,etc,oneeSama,options,stackBlur,state,BackgroundView;function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}return {setters:[],execute:function(){_templateObject=_taggedTemplateLiteral(['#user_bg {\\n\\t\\t\\t\\tbackground: url(',') no-repeat fixed center;\\n\\t\\t\\t\\tbackground-size: cover;\\n\\t\\t\\t}'],['#user_bg {\\n\\t\\t\\t\\tbackground: url(',') no-repeat fixed center;\\n\\t\\t\\t\\tbackground-size: cover;\\n\\t\\t\\t}']);_templateObject2=_taggedTemplateLiteral(['.glass {\\n\\t\\t\\t\\tbackground:\\n\\t\\t\\t\\t\\tlinear-gradient(',', ','),\\n\\t\\t\\t\\t\\turl(',') center fixed no-repeat;\\n\\t\\t\\t\\tbackground-size: cover;\\n\\t\\t\\t}\\n\\t\\t\\t.glass.editing, .editing .background {\\n\\t\\t\\t\\tbackground:\\n\\t\\t\\t\\t\\tlinear-gradient(',', ','),\\n\\t\\t\\t\\t\\turl(',') center fixed no-repeat;\\n\\t\\t\\t\\tbackground-size: cover;\\n\\t\\t\\t}\\n\\t\\t\\t.background {\\n\\t\\t\\t\\tpadding: 10px;\\n\\t\\t\\t\\tmargin: 2px;\\n\\t\\t\\t}'],['.glass {\\n\\t\\t\\t\\tbackground:\\n\\t\\t\\t\\t\\tlinear-gradient(',', ','),\\n\\t\\t\\t\\t\\turl(',') center fixed no-repeat;\\n\\t\\t\\t\\tbackground-size: cover;\\n\\t\\t\\t}\\n\\t\\t\\t.glass.editing, .editing .background {\\n\\t\\t\\t\\tbackground:\\n\\t\\t\\t\\t\\tlinear-gradient(',', ','),\\n\\t\\t\\t\\t\\turl(',') center fixed no-repeat;\\n\\t\\t\\t\\tbackground-size: cover;\\n\\t\\t\\t}\\n\\t\\t\\t.background {\\n\\t\\t\\t\\tpadding: 10px;\\n\\t\\t\\t\\tmargin: 2px;\\n\\t\\t\\t}']);_templateObject3=_taggedTemplateLiteral(['<video autoplay loop ','>\\n\\t\\t\\t\\t<source src=\"','\" type=\"video/webm\">\\n\\t\\t\\t\\t<source src=\"','\" type=\"video/mp4\">\\n\\t\\t\\t</video>'],['<video autoplay loop ','>\\n\\t\\t\\t\\t<source src=\"','\" type=\"video/webm\">\\n\\t\\t\\t\\t<source src=\"','\" type=\"video/mp4\">\\n\\t\\t\\t</video>']);main=require('./main');Backbone=main.Backbone;common=main.common;etc=main.etc;oneeSama=main.oneeSama;options=main.options;stackBlur=main.stackBlur;state=main.state;BackgroundView=Backbone.View.extend({tagName:'style',colourMap:{glass:{normal:'rgba(40, 42, 46, 0.5)',editing:'rgba(145, 145, 145, 0.5)'},ocean:{normal:'rgba(28, 29, 34, 0.781)',editing:'rgba(44, 57, 71, 0.88)'}},initialize:function initialize(){document.head.append(this.el);document.body.append(etc.parseDOM('<div id=\"user_bg\"></div>'));this.render();main.reply('background:store',this.store,this);this.listenTo(options,{'change:userBG':this.render,'change:illyaBGToggle':this.render,'change:illyaMuteToggle':this.render,'change:theme':this.render,'workModeTOG':this.render});},store:function store(target){var _this=this;main.request('loading:show');var reader=new FileReader();reader.readAsDataURL(target.files[0]);reader.onload=function(event){var img=new Image();img.onload=function(){var canvas=document.createElement(\"canvas\");canvas.width=img.width;canvas.height=img.height;canvas.getContext('2d').drawImage(img,0,0,img.width,img.height);localStorage.background=canvas.toDataURL('image/jpeg',0.95);stackBlur.canvas(canvas,0,0,img.width,img.height,10);localStorage.blurred=canvas.toDataURL('image/jpeg',0.95);main.request('loading:hide');if(options.get('userBG'))_this.render();};img.src=event.target.result;};},render:function render(){var el=this.el;el.innerHTML='';if(options.get('illyaBGToggle')&&state.hotConfig.get('ILLYA_DANCE'))this.renderIllya();else if(options.get('userBG')&&!main.oneeSama.workMode)this.renderBackground();},renderBackground:function renderBackground(){var bg=localStorage.background;if(!bg)return;var html=common.parseHTML(_templateObject,bg);var theme=main.oneeSama.workMode?state.hotConfig.get('DEFAULT_CSS'):options.get('theme');if(theme==='glass'||theme==='ocean'){var _localStorage=localStorage;var blurred=_localStorage.blurred;if(blurred)html+=' '+this.renderGlass(theme,blurred);}this.el.innerHTML=html;},renderGlass:function renderGlass(theme,blurred){var _colourMap$theme=this.colourMap[theme];var normal=_colourMap$theme.normal;var editing=_colourMap$theme.editing;return common.parseHTML(_templateObject2,normal,normal,blurred,editing,editing,blurred);},renderIllya:function renderIllya(){var urlBase=main.config.MEDIA_URL+'illya.';this.el.innerHTML=common.parseHTML(_templateObject3,options.get('illyaMuteToggle')&&'muted',urlBase+'webm',urlBase+'mp4');}});main.defer(function(){return module.exports=new BackgroundView();});}};});"],"sourceRoot":"/source/"}