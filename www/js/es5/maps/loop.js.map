{"version":3,"sources":["loop.js"],"names":["System","register","_export","_context","reRenderImages","main","state","page","get","show","options","oneeSama","workMode","document","queryAll","forEach","el","style","display","follow","getImages","image","model","dispatch","func","posts","each","toggleSpoilers","spoiler","toggleAutoGIF","ext","toggleAnonymisation","source","toggle","command","_model$attributes","attributes","name","trip","util","setters","execute","require","on","change:thumbs","change:spoilers","change:autogif","change:anonymise","workModeTOG","reply"],"mappings":"AAAA,YAAaA,QAAOC,YAAY,SAASC,EAAQC,GAAsD,QAASC,KAAoBC,EAAKC,MAAMC,KAAKC,IAAI,YAAY,WAAY,GAAIC,GAA6B,SAAxBC,EAAQF,IAAI,WAAqBH,EAAKM,SAASC,SAAY,OAAH,EAAUC,UAASC,SAAS,aAAaC,QAAQ,SAASC,GAAI,MAAOA,GAAGC,MAAMC,QAAQT,OAAmBU,EAAO,WAAW,MAAOC,GAAU,SAASC,EAAMC,GAAO,MAAOD,IAAOC,EAAMC,SAAS,cAAcF,OAAc,QAASD,GAAUI,GAAMC,EAAMC,KAAK,SAASJ,GAAO,MAAOE,GAAKF,EAAMd,IAAI,SAASc,KAAW,QAASK,KAAiBR,EAAO,WAAW,MAAOC,GAAU,SAASC,EAAMC,GAAO,MAAOD,IAAOA,EAAMO,SAASN,EAAMC,SAAS,cAAcF,OAAc,QAASQ,KAAgBV,EAAO,WAAW,MAAOC,GAAU,SAASC,EAAMC,GAAO,MAAOD,IAAmB,SAAZA,EAAMS,KAAcR,EAAMC,SAAS,cAAcF,OAAc,QAASU,GAAoBC,EAAOC,GAAQd,EAAO,WAAW,GAAIe,GAAQD,EAAO,YAAY,YAAaR,GAAMC,KAAK,SAASJ,GAAO,GAAIa,GAAkBb,EAAMc,WAAeC,EAAKF,EAAkBE,KAASC,EAAKH,EAAkBG,MAAQD,GAAMC,IAAKhB,EAAMC,SAASW,OAAljC,GAAI7B,GAAKkC,EAAKpB,EAAOT,EAAQC,EAASc,CAA4hC,QAAQe,WAAWC,QAAQ,WAAWpC,EAAKqC,QAAQ,UAAUH,EAAKlC,EAAKkC,KAAKpB,EAAOd,EAAKc,OAAOT,EAAQL,EAAKK,QAAQC,EAASN,EAAKM,SAASc,EAAMpB,EAAKC,MAAMmB,MAAMf,EAAQiC,IAAIC,gBAAgBxC,EAAeyC,kBAAkBlB,EAAemB,iBAAiBjB,EAAckB,mBAAmBhB,EAAoBiB,YAAc5C,IAAiBC,EAAK4C,MAAM,iBAAiB,WAAW,MAAOvC,GAAQF,IAAI,cAAcuB,EAAoB,MAAK","file":"loop.js","sourcesContent":["'use strict';System.register([],function(_export,_context){var main,util,follow,options,oneeSama,posts;function reRenderImages(){if(main.state.page.get('catalog')){(function(){var show=options.get(\"thumbs\")!=='hide'&&!main.oneeSama.workMode?'':'none';document.queryAll(\".expanded\").forEach(function(el){return el.style.display=show;});})();}else follow(function(){return getImages(function(image,model){return image&&model.dispatch('renderImage',image);});});}function getImages(func){posts.each(function(model){return func(model.get('image'),model);});}function toggleSpoilers(){follow(function(){return getImages(function(image,model){return image&&image.spoiler&&model.dispatch('renderImage',image);});});}function toggleAutoGIF(){follow(function(){return getImages(function(image,model){return image&&image.ext==='.gif'&&model.dispatch('renderImage',image);});});}function toggleAnonymisation(source,toggle){follow(function(){var command=toggle?'anonymise':'renderName';posts.each(function(model){var _model$attributes=model.attributes;var name=_model$attributes.name;var trip=_model$attributes.trip;if(name||trip)model.dispatch(command);});});}return {setters:[],execute:function(){main=require('./main');util=main.util;follow=main.follow;options=main.options;oneeSama=main.oneeSama;posts=main.state.posts;options.on({'change:thumbs':reRenderImages,'change:spoilers':toggleSpoilers,'change:autogif':toggleAutoGIF,'change:anonymise':toggleAnonymisation,'workModeTOG':reRenderImages});main.reply('loop:anonymise',function(){return options.get('anonymise')&&toggleAnonymisation(null,true);});}};});"],"sourceRoot":"/source/"}