"use strict";System.register(["underscore"],function(e,t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){var t={};try{t=JSON.parse(e)}catch(r){}return t}var i,a,c,u,o;return{setters:[function(e){i=e.isEmpty,a=e.size}],execute:function(){c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u={},window.addEventListener("storage",function(e){var t=e.key,r=e.newValue;t in u&&(u[t].cached=n(r))}),o=function(){function e(t,n){var i=this;r(this,e),this.key=t,u[t]=this,this.expiry=n,this.cached=this.read(),setTimeout(function(){return i.purgeExpired()},5e3)}return c(e,[{key:"now",value:function(){return Math.floor(Date.now()/1e3)}},{key:"purgeAll",value:function(){localStorage.removeItem(this.key)}},{key:"read",value:function(){var e=localStorage.getItem(this.key);return e?n(e):{}}},{key:"has",value:function(e){return!!this.cached[e]}},{key:"writeAll",value:function(e){return i(e)?this.purgeAll():void localStorage.setItem(this.key,JSON.stringify(e))}},{key:"write",value:function(e){return this.cached=this.read(),this.cached[e]=this.now(),this.writeAll(this.cached),a(this.cached)}},{key:"size",value:function(){return a(this.cached)}},{key:"purgeExpired",value:function(){this.cached=this.read();var e=this.now(),t=86400*this.expiry,r=[];for(var n in this.cached)e>this.cached[n]+t&&r.push(n);if(r.length){var i=!0,a=!1,c=void 0;try{for(var u,o=r[Symbol.iterator]();!(i=(u=o.next()).done);i=!0){var n=u.value;delete this.cached[n]}}catch(h){a=!0,c=h}finally{try{!i&&o["return"]&&o["return"]()}finally{if(a)throw c}}this.writeAll(this.cached)}}}]),e}(),e("default",o)}}});
//# sourceMappingURL=maps/memory.js.map
