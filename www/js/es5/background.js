"use strict";System.register([],function(e,n){function r(e,n){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var a,t,o,i,d,g,s,c,l,u,h,p;return{setters:[],execute:function(){a=r(["#user_bg {\n				background: url(",") no-repeat fixed center;\n				background-size: cover;\n			}"],["#user_bg {\n				background: url(",") no-repeat fixed center;\n				background-size: cover;\n			}"]),t=r([".glass {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.glass.editing, .editing .background {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.background {\n				padding: 10px;\n				margin: 2px;\n			}"],[".glass {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.glass.editing, .editing .background {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.background {\n				padding: 10px;\n				margin: 2px;\n			}"]),o=r(["<video autoplay loop ",'>\n				<source src="','" type="video/webm">\n				<source src="','" type="video/mp4">\n			</video>'],["<video autoplay loop ",'>\n				<source src="','" type="video/webm">\n				<source src="','" type="video/mp4">\n			</video>']),i=require("./main"),d=i.Backbone,g=i.common,s=i.etc,c=i.oneeSama,l=i.options,u=i.stackBlur,h=i.state,p=d.View.extend({tagName:"style",colourMap:{glass:{normal:"rgba(40, 42, 46, 0.5)",editing:"rgba(145, 145, 145, 0.5)"},ocean:{normal:"rgba(28, 29, 34, 0.781)",editing:"rgba(44, 57, 71, 0.88)"}},initialize:function(){document.head.append(this.el),document.body.append(s.parseDOM('<div id="user_bg"></div>')),this.render(),i.reply("background:store",this.store,this),this.listenTo(l,{"change:userBG":this.render,"change:illyaBGToggle":this.render,"change:illyaMuteToggle":this.render,"change:theme":this.render,workModeTOG:this.render})},store:function(e){var n=this;i.request("loading:show");var r=new FileReader;r.readAsDataURL(e.files[0]),r.onload=function(e){var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,r.width,r.height),localStorage.background=e.toDataURL("image/jpeg",.95),u.canvas(e,0,0,r.width,r.height,10),localStorage.blurred=e.toDataURL("image/jpeg",.95),i.request("loading:hide"),l.get("userBG")&&n.render()},r.src=e.target.result}},render:function(){var e=this.el;e.innerHTML="",l.get("illyaBGToggle")&&h.hotConfig.get("ILLYA_DANCE")?this.renderIllya():l.get("userBG")&&!i.oneeSama.workMode&&this.renderBackground()},renderBackground:function(){var e=localStorage.background;if(e){var n=g.parseHTML(a,e),r=i.oneeSama.workMode?h.hotConfig.get("DEFAULT_CSS"):l.get("theme");if("glass"===r||"ocean"===r){var t=localStorage,o=t.blurred;o&&(n+=" "+this.renderGlass(r,o))}this.el.innerHTML=n}},renderGlass:function(e,n){var r=this.colourMap[e],a=r.normal,o=r.editing;return g.parseHTML(t,a,a,n,o,o,n)},renderIllya:function(){var e=i.config.MEDIA_URL+"illya.";this.el.innerHTML=g.parseHTML(o,l.get("illyaMuteToggle")&&"muted",e+"webm",e+"mp4")}}),i.defer(function(){return module.exports=new p})}}});
//# sourceMappingURL=maps/background.js.map
