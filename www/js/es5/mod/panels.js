"use strict";System.register([],function(e,t){function n(e,t){var n="<table>",r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;n+="<tr>";var d=!0,u=!1,c=void 0;try{for(var h,m=t(l)[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var f=h.value;n+="<td>"+f+"</td>"}}catch(v){u=!0,c=v}finally{try{!d&&m["return"]&&m["return"]()}finally{if(u)throw c}}n+="</tr>"}}catch(v){i=!0,a=v}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n+="</table>"}var r,i,a,o,s,l,d,u,c,h,m,f,v,p,y;return{setters:[],execute:function(){r=require("main"),i=r._,a=r.Backbone,o=r.common,s=r.dispatcher,l=r.etc,d=r.oneeSama,u=r.lang,c=r.modals,h=r.Memory,m=r.state,f=a.View.extend({className:"modal mod panel glass",initialize:function(){var e=this;this.$el.appendTo(r.$overlay),c[this.type]=this,s[this.kind]=function(t){return e.render(t[0])},r.send([this.kind])},render:function(e){return e.length?(this.el.innerHTML=this.renderContents(e),this.postRender&&this.postRender(),this.el.scrollTop=this.el.scrollHeight,this):this.el.innerHTML="God's in his Heaven. All's right with the world."},kill:function(){delete s[this.kind],delete c[this.type],this.remove()}}),v=f.extend({type:"log",kind:o.MOD_LOG,renderContents:function(e){return n(e,function(e){return[e.num?d.postRef(e.num,e.op):"",u.mod.formatLog(e),d.time(e.time)]})}}),exports.log=v,p=f.extend({type:"adminPanel",id:"adminPanel",kind:o.ADMIN_PANEL,events:{"click .unban":"unban"},renderContents:function(e){var t=this;return this.banCount=0,n(e,function(e){return t.banCount++,[d.mnemonic(e[0]),d.time(e[1]),'<a class="unban" data-id="'+e[0]+'">'+u.mod.unban+"</a>"]})},unban:function(e){var t=e.target;r.send([o.UNBAN,t.getAttribute("data-id")]),t.parentElement.parentElement.remove(),--this.banCount||this.kill()}}),exports.adminPanel=p,y=f.extend({type:"djPanel",events:{"click .close":"removeRequest","click #rescan":"scan"},initialize:function(){r.$overlay[0].append(this.el),c[this.type]=this,this.removed=new h("request",2),this.scan()},scan:function(){var e=this.removed.readAll(),t=[],n=!0,r=!1,a=void 0;try{for(var o,s=m.posts.models[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value.attributes;if(!(l.num in e)){var d=l.body.match(/\/r\/[^\n]+$/gm);if(d){var u=!0,c=!1,h=void 0;try{for(var f,v=d[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var p=f.value;p=p.replace("/r/","").trim(),t.push([l.num,l.mnemonic,p])}}catch(y){c=!0,h=y}finally{try{!u&&v["return"]&&v["return"]()}finally{if(c)throw h}}}}}}catch(y){r=!0,a=y}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw a}}return this.render(i.sortBy(t,1))},renderContents:function(e){return n(e,function(e){return[d.postRef(e[0],d.op).safe,d.mnemonic(e[1]),e[2],'<a class="close" data-id="'+e[0]+'">X</a>']})},postRender:function(){this.el.append(l.parseDOM('<a id="rescan">'+u.rescan+"</a>")[0])},removeRequest:function(e){e.preventDefault();var t=e.target;this.removed.write(t.getAttribute("data-id")),t.closest("tr").remove()}}),exports.djPanel=y}}});
//# sourceMappingURL=../maps/mod/panels.js.map
