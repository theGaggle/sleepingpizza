"use strict";System.register([],function(e,t){function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,n;return{setters:[],execute:function(){r=function(){function e(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,s,r){return s&&e(t.prototype,s),r&&e(t,r),t}}(),n=function(){function e(t){s(this,e),this.state=t,this.spec={acts:{},ons:{},wilds:{},preflights:{}}}return r(e,[{key:"clone",value:function(){var t=new e(this.state);return t.spec=this.spec,t}},{key:"on",value:function(e,t){var s=this.spec.ons[e];s?s.push(t):this.spec.ons[e]=[t]}},{key:"preflight",value:function(e,t){var s=this.spec.preflights[e];s?s.push(t):this.spec.preflights[e]=[t]}},{key:"act",value:function(e,t){var s=e.split("->");if(2!=s.length)throw new Error("Bad FSM spec: "+e);for(var r=s[0].split(","),n=s[1].match(/^\s*(\w+)\s*$/)[1],i=void 0,a=r.length-1;a>=0;a--){var c=r[a],o=c.match(/^\s*(\*|\w+)\s*(?:\+\s*(\w+)\s*)?$/);if(!o)throw new Error("Bad FSM spec portion: "+c);if(o[2]&&(i=o[2]),!i)throw new Error("Tokenless FSM action: "+c);var u=o[1];if("*"==u)this.spec.wilds[i]=n;else{var f=this.spec.acts[u];f||(this.spec.acts[u]=f={}),f[i]=n}}t&&this.on(n,t)}},{key:"feed",value:function(e,t){var s=this.spec,r=this.state,n=s.acts[r],i=n&&n[e]||s.wilds[e];if(i&&r!=i){for(var a=s.preflights[i],c=0;a&&c<a.length;c++)if(!a[c].call(this,t))return!1;this.state=i;for(var o=s.ons[i],c=0;o&&c<o.length;c++)o[c].call(this,t)}return!0}},{key:"feeder",value:function(e){var t=this;return function(s){return t.feed(e,s)}}}]),e}(),e("default",n)}}});
//# sourceMappingURL=maps/fsm.js.map
