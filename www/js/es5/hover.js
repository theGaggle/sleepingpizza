"use strict";System.register([],function(e,t){var i,n,s,r,o,a,h,c,l,d,u,m,p;return{setters:[],execute:function(){i=require("./main"),n=i.posts.Article,s=i.$,r=i.Backbone,o=i.etc,a=i.options,h=i.state,c=new r.Model,l=r.View.extend({initialize:function(){var e=this;this.listenTo(this.model,"change:event",this.check),i.reply("imager:clicked",function(){return e.$el.empty()})},check:function(e,t){if(a.get("imageHover")){var i=s(t.target);if(!i.is("img")||i.hasClass("expanded"))return this.$el.children().remove("img,video");var n=i.closest("a").attr("href"),r=/\.webm$/.test(n);return/\.pdf$/.test(n)||/\.mp3$/.test(n)||r&&!a.get("webmHover")?this.$el.empty():void s(r?"<video/>":"<img/>",{src:n,autoplay:!0,loop:!0}).appendTo(this.$el.empty())}}}),d=n.extend({initialize:function(e){this.parentNum=e.parentNum,this.listenTo(this.model,"dispatch",this.redirect).render().$el.addClass("preview"),this.update()},update:function(){this.num||(this.num=o.getID(this.el)),p.render(this.$el,this.parentNum)}}),u=r.View.extend({initialize:function(){this.listenTo(this.model,"change:event",this.check)},check:function(e,t){var i=this,n=s(t.target);if(n.is("a.history")){var r=n.text().match(/^>>(\d+)/);if(r){var a=h.posts.get(r[1]);a&&(this.targetPos=n.offset(),this.previewView=new d({model:a,parentNum:o.getID(t.target)}),n.one("mouseleave click",function(){return i.remove()}))}}},remove:function(){this.previewView&&(this.targetPos=null,this.previewView.remove(),this.stopListening(this.previewView),this.$el.children().remove(".preview"),this.previewView=null)},render:function(e,t){e.find("a.history").filter(function(){return this.text.includes(">>"+t)}).each(function(){s(this).addClass("referenced")}),e.css(this.position(e)).appendTo(this.$el.empty())},position:function(e){e.hide(),s(document.body).append(e);var t=e.width(),i=e.height();e.detach().show();var n=s(window),r=this.targetPos.left-n.scrollLeft(),o=this.targetPos.top-n.scrollTop()-i-17;0>o&&(o+=i+34);var a=r+t-n.innerWidth();return a>-30&&(r=Math.max(0,r-a-30)),{left:r,top:o}}}),m=void 0,p=void 0,i.isMobile||i.defer(function(){i.$doc.on("mousemove",function(e){e.target!=m&&(c.set("event",e),m=e.target)});var e=document.getElementById("hover_overlay");new l({model:c,el:e}),p=new u({model:c,el:e})})}}});
//# sourceMappingURL=maps/hover.js.map
