"use strict";System.register([],function(e,n){function t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){if(e){var t=p.mine.readAll();for(var r in e)r in t&&u.request("repliedToMe",n)}}function i(e,n){var t=p.posts.get(e);t&&n(t)}var o,s,u,a,c,d,f,l,p,g;return{setters:[],execute:function(){s=function(){function e(e,n){var t=[],r=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done)&&(t.push(s.value),!n||t.length!==n);r=!0);}catch(a){i=!0,o=a}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=require("./main"),a=u._,c=u.common,d=u.dispatcher,f=u.util,l=u.posts,p=u.state,g=document.query("#onlineCount"),a.extend(d,(o={},t(o,c.INSERT_POST,function(e){var n=s(e,2),t=n[0],i=n[1];i=i&&p.page.get("live");var o=!t.op,a=t.num;o&&(p.syncs[a]=1),t.editing=!0;var c=void 0,d=t.nonce;delete t.nonce;var f=u.request("nonce:get")[d];if(f&&f.tab===p.page.get("tabID")){p.ownPosts[a]=!0,u.oneeSama.trigger("insertOwnPost",t),u.postSM.feed("alloc",t),i=!1,u.request("nonce:destroy",d);var g=u.request("postForm");g&&g.el&&(c=g.el)}f&&(t.mine=!0,p.mine.write(a)),p.addLinks(t.links);var v=new l.models[o?"Thread":"Post"](t),m=new l[o?"Section":"Article"]({model:v,el:c,id:a});if(c||m.render().insertIntoDOM(),m.clientInit(),r(t.links,a),u.request("post:inserted",v),!o){var I=p.posts.get(t.op);I&&(I.get("replies").push(a),p.page.get("thread")||(I.dispatch("shiftReplies"),i&&I.dispatch("bumpThread")))}}),t(o,c.INSERT_IMAGE,function(e){var n=s(e,2),t=n[0],r=n[1],o=u.request("postModel"),a=o&&o.get("num")==t;a&&u.request("postForm").insertUploaded(r),i(t,function(e){return e.setImage(r,a)})}),t(o,c.UPDATE_POST,function(e){var n=s(e,3),t=n[0],o=n[1],a=n[2],c=void 0===a?{}:a;i(t,function(e){p.addLinks(c.links),e.update(o,c),r(c.links,t),t in p.ownPosts?u.oneeSama.trigger("insertOwnPost",c):e.dispatch("updateBody",o)})}),t(o,c.FINISH_POST,function(e){var n=s(e,1),t=n[0];delete p.ownPosts[t],i(t,function(e){e.set("editing",!1),e.dispatch("renderEditing",!1)})}),t(o,c.DELETE_POSTS,function(e){i(e[0],function(n){return n.deletePost(e[1])})}),t(o,c.LOCK_THREAD,function(e){i(e[0],function(n){return n.toggleLocked(!0,e[1])})}),t(o,c.UNLOCK_THREAD,function(e){i(e[0],function(n){return n.toggleLocked(!1,e[1])})}),t(o,c.DELETE_IMAGES,function(e){i(e[0],function(n){return n.removeImage(e[1])})}),t(o,c.SPOILER_IMAGES,function(e){i(e[0],function(n){return n.setSpoiler(e[1],e[2])})}),t(o,c.BAN,function(e){var n=s(e,2),t=n[0],r=n[1];if(!t){if(!r)return;r=JSON.parse(r),t=r.num}i(t,function(e){return e.setBan(t,r)})}),t(o,c.BACKLINK,function(e){i(e[0],function(n){return n.addBacklink(e[1],e[2])})}),t(o,c.ONLINE_COUNT,function(e){g.textContent="["+e[0]+"]"}),t(o,c.HOT_INJECTION,function(e){var n=s(e,3),t=n[0],r=n[1],i=n[2];t||r===p.configHash?t&&(p.configHash=r,p.hotConfig.set(i)):u.send([c.HOT_INJECTION,!0])}),o)),d[c.SYNCHRONIZE]=u.connSM.feeder("sync"),d[c.INVALID]=u.connSM.feeder("invalid"),f.listener(document,"click","del",function(e){e.spoilt||(e.spoilt=!0,e.target.classList.toggle("reveal"))})}}});
//# sourceMappingURL=maps/client.js.map
